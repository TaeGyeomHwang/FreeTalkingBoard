<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layouts/layout1}">
<head>
    <meta charset="UTF-8">
    <title>Signup</title>
    <!-- jQuery 로드 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- CSS 스크립트 -->
    <layout:fragment name="css">
        <style>
            .fieldError {
                color: #bd2130;
            }
        </style>
    </layout:fragment>

    <!-- 자바스크립트 -->
    <layout:fragment name="script">
        <script th:inline="javascript">
            $(document).ready(function () {
                var errorMessage = '${errorMessage}';
                if (errorMessage != null) {
                    alert(errorMessage);
                }
            });

            <!--비밀번호 재확인 스크립트 -->
            function check() {
                let password = $("#password").val();
                let passwordCheck = $("#passwordCheck").val();

                if (password != passwordCheck) {
                    $("#check").show();
                } else {
                    $("check").hide();
                }
            }
            $(document).ready(function () {
                $("#check").hide();
            });
        </script>
    </layout:fragment>

</head>
<body>
<div layout:fragment="content">

    <form action="/members/new" role="form" method="post" th:object="${memberFormDto}">
        <!-- 이메일 -->
        <div class="form-group">
            <label th:for="email">이메일 주소 : </label>
            <input type="email" class="form-control" th:field="${memberFormDto.email}" placeholder="이메일을 입력해주세요.">
            <p th:if="${#fields.hasErrors('email')}" th:errors="${memberFormDto.email}" class="fieldError">Incorrect data</p>
        </div>

        <!--  비밀번호/비밀번호 재확인 -->
        <div class="form-group">
            <label th:for="password">비밀번호 : </label>
            <input type="password" th:field="${memberFormDto.password}" class="form-control" id="password" placeholder="비밀번호를 입력해주세요.">
            <p th:if="${#fields.hasErrors('password')}" th:errors="${memberFormDto.password}" class="fieldError">Incorrect data</p>
        </div>
        <!--  비밀번호 재확인 -->
        <div class="form-group is-invalid">
            <label th:for="password">비밀번호 확인 : </label>
            <input type="password" th:field="${memberFormDto.password}" class="form-control" id="passwordCheck" placeholder="비밀번호를 재입력해주세요." onchange="check()">
            <p th:if="${#fields.hasErrors('password')}" th:errors="${memberFormDto.password}" class="fieldError">Incorrect data</p>
        </div>
        <div id="check" class="invalid-feedback mb-1 m-1">
            비밀번호가 동일하지 않습니다.
        </div>

        <!-- 이름 -->
        <div class="form-group">
            <label th:for="name">이름 : </label>
            <input type="text" th:field="${memberFormDto.name}" class="form-control" placeholder="이름을 입력해주세요.">
            <p th:if="${#fields.hasErrors('name')}" th:errors="${memberFormDto.name}" class="fieldError">Incorrect data</p>
        </div>

        <!-- 회원가입 버튼 -->
        <div style="text-align: center">
            <button type="submit" class="btn btn-primary" style="">회원가입</button>
        </div>

        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

    </form>
</div>

</body>
</html>
